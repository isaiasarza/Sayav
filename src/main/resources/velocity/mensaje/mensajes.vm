#parse("/velocity/layout.vm") 
#@mainLayout() 
  <h1>$msg.get("LIST_MESSAGE_HEADING")</h1> 
    
    #if($mostrarNotificacion) 
    <div class="infoAlert">   
         <span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>Prueba 
     </div> 
  #end 

 
         
  <table> 
   
      <tr> 
        <th align="center">Origen</th> 
        <th align="center">Destino</th> 
        <th align="center">
        	<div class="dropdown">
  				<button onclick="myFunction()" class="dropbtn">Estado</button>
  				<div id="myDropdown" class="dropdown-content">
  				<form method="get" action="$WebPath.getViewAllMessages()$estados.getPendiente()/"> 
   					<button class="w3-button">Pendiente</button>               
           		</form> 
           		<form method="get" action="$WebPath.getViewAllMessages()$estados.getConfirmado()/"> 
   					<button  class="w3-button">Confirmado</button>                 
           		</form> 
           		<form method="get" action="$WebPath.getViewAllMessages()$estados.getZombie()/"> 
   					<button  class="w3-button">Zombie</button>                 
           		</form> 
    				
  				</div>
			</div>
        </th> 
        <th align="center">Tipo</th>        
       	<th align="center">Detalle</th> 
       	
       	##<th align="center">Eliminar</th> 
         
       
      #foreach($!m in $!mensajesPendientes.getMensaje())
      
 
      <tr> 
            <td> $!m.getOrigen()</td> 
            <td> $!m.getDestino()</td> 
            <td> $!m.getEstado()</td> 
            <td> $!m.getTipoMensaje().getTipo()</td>
	       	<td> <button onclick="document.getElementById($foreach.count).style.display='block'"
			class="w3-button">Ver</button></td>	 
			
			  <!-- Modal donde se muestra el detalle del mensaje -->
		<div id=$foreach.count class="w3-modal">
  			<div class="w3-modal-content w3-animate-top">

    			<header class="w3-container w3-teal"> 
      				<span onclick="document.getElementById($foreach.count).style.display='none'" 
      				class="w3-button w3-display-topright">&times;</span>
      				<h2>Detalle</h2>
				</header>

    			<div class="w3-container">
			 		<p>Creacion: $!m.imprimirFechaCreacion()</p>
			 		<p>Reenvio: $!m.imprimirFechaReenvio()</p>
    				#foreach($!s1 in $!m.getDescripcion().split(":"))
    					<p>$!s1</p>
					 #end 
    				
    				 #foreach($!s2 in $!m.getDetalle().split(":"))
    					<p>$!s2</p>
				 	#end 
    			</div>

    		</div>
		</div>	
  	             
      </tr> 
     
      #end 
       
    </table>     
       
<script>

/* When the user clicks on the button, 
toggle between hiding and showing the dropdown content */
function myFunction() {
    document.getElementById("myDropdown").classList.toggle("show");
}

// Close the dropdown menu if the user clicks outside of it
window.onclick = function(event) {
  if (!event.target.matches('.dropbtn')) {

    var dropdowns = document.getElementsByClassName("dropdown-content");
    var i;
    for (i = 0; i < dropdowns.length; i++) {
      var openDropdown = dropdowns[i];
      if (openDropdown.classList.contains('show')) {
        openDropdown.classList.remove('show');
      }
    }
  }
}
</script>

#end 